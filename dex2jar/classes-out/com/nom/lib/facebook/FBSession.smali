.class public Lcom/nom/lib/facebook/FBSession;
.super Ljava/lang/Object;
.source "FBSession.java"

.field private final static KEY_FB_TOKEN:Ljava/lang/String; = "|fb|"

.field private static PERMISSIONS:[Ljava/lang/String;

.field private static instance:Lcom/nom/lib/facebook/FBSession;

.field private final FB_APP_ID:Ljava/lang/String;

.field private mAsyncRunner:Lcom/facebook/android/AsyncFacebookRunner;

.field private mFacebook:Lcom/facebook/android/Facebook;

.field mListeners:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/nom/lib/js/YGAuthenticationListener;",
            ">;"
        }
    .end annotation
.end field

.field private mPrefs:Lcom/nom/lib/app/Preferences;

.method static constructor <clinit>()V
    .registers 3
    .prologue
    .line 20
    const/4 v0, 0
    sput-object v0, Lcom/nom/lib/facebook/FBSession;->instance:Lcom/nom/lib/facebook/FBSession;
    .line 31
    const/16 v0, 9
    new-array v0, v0, [Ljava/lang/String;
    const/4 v1, 0
    const-string v2, "email"
    aput-object v2, v0, v1
    const/4 v1, 1
    .line 32
    const-string v2, "read_stream"
    aput-object v2, v0, v1
    const/4 v1, 2
    .line 33
    const-string v2, "publish_stream"
    aput-object v2, v0, v1
    const/4 v1, 3
    .line 34
    const-string v2, "offline_access"
    aput-object v2, v0, v1
    const/4 v1, 4
    .line 35
    const-string v2, "user_birthday"
    aput-object v2, v0, v1
    const/4 v1, 5
    .line 36
    const-string v2, "user_location"
    aput-object v2, v0, v1
    const/4 v1, 6
    .line 37
    const-string v2, "user_photos"
    aput-object v2, v0, v1
    const/4 v1, 7
    .line 38
    const-string v2, "user_relationships"
    aput-object v2, v0, v1
    const/16 v1, 8
    .line 39
    const-string v2, "user_relationship_details"
    aput-object v2, v0, v1
    .line 31
    sput-object v0, Lcom/nom/lib/facebook/FBSession;->PERMISSIONS:[Ljava/lang/String;
    .line 16
    return-void
.end method

.method public constructor <init>(Landroid/content/Context;)V
    .registers 4
    .prologue
    .line 49
    invoke-direct { p0 }, Ljava/lang/Object;-><init>()V
    .line 26
    const-string v0, "174004489323348"
    iput-object v0, p0, Lcom/nom/lib/facebook/FBSession;->FB_APP_ID:Ljava/lang/String;
    .line 100
    new-instance v0, Ljava/util/ArrayList;
    invoke-direct { v0 }, Ljava/util/ArrayList;-><init>()V
    iput-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mListeners:Ljava/util/ArrayList;
    .line 50
    if-nez p1, :L0
    .line 51
    new-instance v0, Ljava/lang/IllegalArgumentException;
    const-string v1, "The argument 'context' cannot be null"
    invoke-direct { v0, v1 }, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
    throw v0
    :L0
    .line 54
    check-cast p1, Lcom/nom/lib/app/YGApplication;
    .end local p1
    invoke-virtual { p1 }, Lcom/nom/lib/app/YGApplication;->getPreferences()Lcom/nom/lib/app/Preferences;
    move-result-object v0
    iput-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mPrefs:Lcom/nom/lib/app/Preferences;
    .line 55
    const/4 v0, 0
    iput-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mFacebook:Lcom/facebook/android/Facebook;
    .line 56
    return-void
.end method

.method public static createInstance(Landroid/content/Context;)V
    .registers 2
    .prologue
    .line 42
    new-instance v0, Lcom/nom/lib/facebook/FBSession;
    invoke-direct { v0, p0 }, Lcom/nom/lib/facebook/FBSession;-><init>(Landroid/content/Context;)V
    sput-object v0, Lcom/nom/lib/facebook/FBSession;->instance:Lcom/nom/lib/facebook/FBSession;
    .line 43
    return-void
.end method

.method public static getInstance()Lcom/nom/lib/facebook/FBSession;
    .registers 1
    .prologue
    .line 46
    sget-object v0, Lcom/nom/lib/facebook/FBSession;->instance:Lcom/nom/lib/facebook/FBSession;
    return-object v0
.end method

.method public addAuthListener(Lcom/nom/lib/js/YGAuthenticationListener;)V
    .registers 3
    .prologue
    .line 89
    if-eqz p1, :L0
    iget-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mListeners:Ljava/util/ArrayList;
    invoke-virtual { v0, p1 }, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z
    move-result v0
    if-nez v0, :L0
    .line 90
    iget-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mListeners:Ljava/util/ArrayList;
    invoke-virtual { v0, p1 }, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :L0
    .line 92
    return-void
.end method

.method public authorizeCallback(IILandroid/content/Intent;)V
    .registers 5
    .prologue
    .line 79
    iget-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mFacebook:Lcom/facebook/android/Facebook;
    if-eqz v0, :L0
    .line 80
    iget-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mFacebook:Lcom/facebook/android/Facebook;
    invoke-virtual { v0, p1, p2, p3 }, Lcom/facebook/android/Facebook;->authorizeCallback(IILandroid/content/Intent;)V
    :L0
    .line 82
    return-void
.end method

.method public isConnected()Z
    .registers 3
    .prologue
    .line 60
    iget-object v1, p0, Lcom/nom/lib/facebook/FBSession;->mPrefs:Lcom/nom/lib/app/Preferences;
    invoke-virtual { v1 }, Lcom/nom/lib/app/Preferences;->getYoinkToken()Ljava/lang/String;
    move-result-object v0
    .line 61
    .local v0, yoinkToken:Ljava/lang/String;
    if-eqz v0, :L0
    const-string v1, "|fb|"
    invoke-virtual { v0, v1 }, Ljava/lang/String;->indexOf(Ljava/lang/String;)I
    move-result v1
    if-gez v1, :L2
    :L0
    const/4 v1, 0
    :L1
    return v1
    :L2
    const/4 v1, 1
    goto :L1
.end method

.method public login(Landroid/app/Activity;)V
    .registers 6
    .prologue
    .line 65
    invoke-virtual { p0 }, Lcom/nom/lib/facebook/FBSession;->isConnected()Z
    move-result v0
    if-eqz v0, :L1
    :L0
    .line 76
    return-void
    :L1
    .line 69
    iget-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mFacebook:Lcom/facebook/android/Facebook;
    if-nez v0, :L2
    .line 70
    new-instance v0, Lcom/facebook/android/Facebook;
    const-string v1, "174004489323348"
    invoke-direct { v0, v1 }, Lcom/facebook/android/Facebook;-><init>(Ljava/lang/String;)V
    iput-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mFacebook:Lcom/facebook/android/Facebook;
    :L2
    .line 74
    iget-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mFacebook:Lcom/facebook/android/Facebook;
    sget-object v1, Lcom/nom/lib/facebook/FBSession;->PERMISSIONS:[Ljava/lang/String;
    .line 75
    new-instance v2, Lcom/nom/lib/facebook/FBConnectDialogListener;
    iget-object v3, p0, Lcom/nom/lib/facebook/FBSession;->mFacebook:Lcom/facebook/android/Facebook;
    invoke-direct { v2, p1, v3 }, Lcom/nom/lib/facebook/FBConnectDialogListener;-><init>(Landroid/app/Activity;Lcom/facebook/android/Facebook;)V
    .line 74
    invoke-virtual { v0, p1, v1, v2 }, Lcom/facebook/android/Facebook;->authorize(Landroid/app/Activity;[Ljava/lang/String;Lcom/facebook/android/Facebook$DialogListener;)V
    goto :L0
.end method

.method public loginFailed(ILjava/lang/String;)V
    .registers 7
    .prologue
    .line 113
    iget-object v3, p0, Lcom/nom/lib/facebook/FBSession;->mListeners:Ljava/util/ArrayList;
    invoke-virtual { v3 }, Ljava/util/ArrayList;->clone()Ljava/lang/Object;
    move-result-object v0
    check-cast v0, Ljava/util/ArrayList;
    .line 114
    .local v0, croneListeners:Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/nom/lib/js/YGAuthenticationListener;>;"
    invoke-virtual { v0 }, Ljava/util/ArrayList;->listIterator()Ljava/util/ListIterator;
    move-result-object v1
    :L0
    .line 115
    .local v1, iter:Ljava/util/ListIterator;, "Ljava/util/ListIterator<Lcom/nom/lib/js/YGAuthenticationListener;>;"
    invoke-interface { v1 }, Ljava/util/ListIterator;->hasNext()Z
    move-result v3
    if-nez v3, :L1
    .line 119
    return-void
    :L1
    .line 116
    invoke-interface { v1 }, Ljava/util/ListIterator;->next()Ljava/lang/Object;
    move-result-object v2
    check-cast v2, Lcom/nom/lib/js/YGAuthenticationListener;
    .line 117
    .local v2, listener:Lcom/nom/lib/js/YGAuthenticationListener;
    invoke-interface { v2, p1, p2 }, Lcom/nom/lib/js/YGAuthenticationListener;->loginFailed(ILjava/lang/String;)V
    goto :L0
.end method

.method public loginSuccess(Ljava/lang/String;)V
    .registers 6
    .prologue
    .line 103
    iget-object v3, p0, Lcom/nom/lib/facebook/FBSession;->mListeners:Ljava/util/ArrayList;
    invoke-virtual { v3 }, Ljava/util/ArrayList;->clone()Ljava/lang/Object;
    move-result-object v0
    check-cast v0, Ljava/util/ArrayList;
    .line 104
    .local v0, croneListeners:Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/nom/lib/js/YGAuthenticationListener;>;"
    invoke-virtual { v0 }, Ljava/util/ArrayList;->listIterator()Ljava/util/ListIterator;
    move-result-object v1
    :L0
    .line 105
    .local v1, iter:Ljava/util/ListIterator;, "Ljava/util/ListIterator<Lcom/nom/lib/js/YGAuthenticationListener;>;"
    invoke-interface { v1 }, Ljava/util/ListIterator;->hasNext()Z
    move-result v3
    if-nez v3, :L1
    .line 109
    return-void
    :L1
    .line 106
    invoke-interface { v1 }, Ljava/util/ListIterator;->next()Ljava/lang/Object;
    move-result-object v2
    check-cast v2, Lcom/nom/lib/js/YGAuthenticationListener;
    .line 107
    .local v2, listener:Lcom/nom/lib/js/YGAuthenticationListener;
    invoke-interface { v2, p1 }, Lcom/nom/lib/js/YGAuthenticationListener;->loginSucceeded(Ljava/lang/String;)V
    goto :L0
.end method

.method public logout(Landroid/app/Activity;)V
    .registers 2
    .prologue
    .line 86
    return-void
.end method

.method public removeAuthListener(Lcom/nom/lib/js/YGAuthenticationListener;)V
    .registers 3
    .prologue
    .line 95
    if-eqz p1, :L0
    .line 96
    iget-object v0, p0, Lcom/nom/lib/facebook/FBSession;->mListeners:Ljava/util/ArrayList;
    invoke-virtual { v0, p1 }, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z
    :L0
    .line 98
    return-void
.end method
