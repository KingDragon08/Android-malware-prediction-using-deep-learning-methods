.class Lcom/nom/lib/database/ImageCache$DatabaseHelper;
.super Landroid/database/sqlite/SQLiteOpenHelper;
.source "ImageCache.java"

.annotation system Ldalvik/annotation/EnclosingClass;
    value = Lcom/nom/lib/database/ImageCache;
.end annotation
.annotation system Ldalvik/annotation/InnerClass;
    accessFlags = 10
    name = "DatabaseHelper"
.end annotation

.field private mTableName:Ljava/lang/String;

.method constructor <init>(Landroid/content/Context;Ljava/lang/String;)V
    .registers 6
    .prologue
    .line 255
    const-string v0, "image_cache"
    const/4 v1, 0
    const/4 v2, 1
    invoke-direct { p0, p1, v0, v1, v2 }, Landroid/database/sqlite/SQLiteOpenHelper;-><init>(Landroid/content/Context;Ljava/lang/String;Landroid/database/sqlite/SQLiteDatabase$CursorFactory;I)V
    .line 256
    iput-object p2, p0, Lcom/nom/lib/database/ImageCache$DatabaseHelper;->mTableName:Ljava/lang/String;
    .line 257
    return-void
.end method

.method private createTable(Landroid/database/sqlite/SQLiteDatabase;)V
    .registers 5
    .prologue
    .line 283
    new-instance v1, Ljava/lang/StringBuilder;
    const-string v2, "CREATE TABLE IF NOT EXISTS "
    invoke-direct { v1, v2 }, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
    iget-object v2, p0, Lcom/nom/lib/database/ImageCache$DatabaseHelper;->mTableName:Ljava/lang/String;
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    const-string v2, " ("
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    .line 284
    const-string v2, "key"
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    const-string v2, " TEXT PRIMARY KEY, "
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    .line 285
    const-string v2, "pinned"
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    const-string v2, " INTEGER NOT NULL, "
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    .line 286
    const-string v2, "last_use_time"
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    const-string v2, " INTEGER NOT NULL, "
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    .line 287
    const-string v2, "size"
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    const-string v2, " INTEGER NOT NULL, "
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    .line 288
    const-string v2, "data"
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    const-string v2, " BLOB NOT NULL)"
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    .line 283
    invoke-virtual { v1 }, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
    move-result-object v0
    .line 289
    .local v0, createStmt:Ljava/lang/String;
    invoke-virtual { p1, v0 }, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V
    .line 290
    return-void
.end method

.method private dropTable(Landroid/database/sqlite/SQLiteDatabase;)V
    .registers 4
    .prologue
    .line 293
    new-instance v0, Ljava/lang/StringBuilder;
    const-string v1, "DROP TABLE IF EXISTS "
    invoke-direct { v0, v1 }, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
    iget-object v1, p0, Lcom/nom/lib/database/ImageCache$DatabaseHelper;->mTableName:Ljava/lang/String;
    invoke-virtual { v0, v1 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v0
    invoke-virtual { v0 }, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
    move-result-object v0
    invoke-virtual { p1, v0 }, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V
    .line 294
    return-void
.end method

.method public onCreate(Landroid/database/sqlite/SQLiteDatabase;)V
    .registers 2
    .prologue
    .line 261
    invoke-direct { p0, p1 }, Lcom/nom/lib/database/ImageCache$DatabaseHelper;->createTable(Landroid/database/sqlite/SQLiteDatabase;)V
    .line 262
    return-void
.end method

.method public onOpen(Landroid/database/sqlite/SQLiteDatabase;)V
    .registers 3
    .prologue
    .line 267
    invoke-virtual { p1 }, Landroid/database/sqlite/SQLiteDatabase;->isReadOnly()Z
    move-result v0
    if-nez v0, :L0
    .line 268
    invoke-direct { p0, p1 }, Lcom/nom/lib/database/ImageCache$DatabaseHelper;->createTable(Landroid/database/sqlite/SQLiteDatabase;)V
    :L0
    .line 270
    return-void
.end method

.method public onUpgrade(Landroid/database/sqlite/SQLiteDatabase;II)V
    .registers 7
    .prologue
    .line 274
    const-class v0, Lcom/nom/lib/database/ImageCache;
    invoke-virtual { v0 }, Ljava/lang/Class;->getName()Ljava/lang/String;
    move-result-object v0
    new-instance v1, Ljava/lang/StringBuilder;
    const-string v2, "Upgrading database from version "
    invoke-direct { v1, v2 }, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
    invoke-virtual { v1, p2 }, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
    move-result-object v1
    const-string v2, " to "
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    .line 275
    invoke-virtual { v1, p3 }, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
    move-result-object v1
    const-string v2, ", which will destroy all old data"
    invoke-virtual { v1, v2 }, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    move-result-object v1
    invoke-virtual { v1 }, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
    move-result-object v1
    .line 274
    invoke-static { v0, v1 }, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
    .line 276
    invoke-direct { p0, p1 }, Lcom/nom/lib/database/ImageCache$DatabaseHelper;->dropTable(Landroid/database/sqlite/SQLiteDatabase;)V
    .line 277
    invoke-virtual { p0, p1 }, Lcom/nom/lib/database/ImageCache$DatabaseHelper;->onCreate(Landroid/database/sqlite/SQLiteDatabase;)V
    .line 278
    return-void
.end method
