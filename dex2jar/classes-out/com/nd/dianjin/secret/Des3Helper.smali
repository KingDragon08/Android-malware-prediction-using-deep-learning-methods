.class public Lcom/nd/dianjin/secret/Des3Helper;
.super Ljava/lang/Object;

.field private static a:[C

.field public static key:Ljava/lang/String;

.method static constructor <clinit>()V
    .registers 1
    const/16 v0, 16
    new-array v0, v0, [C
    fill-array-data v0, :L0
    sput-object v0, Lcom/nd/dianjin/secret/Des3Helper;->a:[C
    return-void
    :L0
    .array-data 2
        48t 0t
        49t 0t
        50t 0t
        51t 0t
        52t 0t
        53t 0t
        54t 0t
        55t 0t
        56t 0t
        57t 0t
        97t 0t
        98t 0t
        99t 0t
        100t 0t
        101t 0t
        102t 0t
    .end array-data
.end method

.method public constructor <init>()V
    .registers 1
    invoke-direct { p0 }, Ljava/lang/Object;-><init>()V
    return-void
.end method

.method public static Des3Encrypt([B)[B
    .registers 8
    const/16 v6, 8
    const/4 v5, 0
    sget-object v0, Lcom/nd/dianjin/secret/Des3Helper;->key:Ljava/lang/String;
    invoke-virtual { v0 }, Ljava/lang/String;->getBytes()[B
    move-result-object v0
    const-string v1, "DESede/CBC/PKCS7Padding"
    invoke-static { v1 }, Ljavax/crypto/Cipher;->getInstance(Ljava/lang/String;)Ljavax/crypto/Cipher;
    move-result-object v1
    const-string v2, "DESede"
    invoke-static { v2 }, Ljavax/crypto/SecretKeyFactory;->getInstance(Ljava/lang/String;)Ljavax/crypto/SecretKeyFactory;
    move-result-object v2
    new-instance v3, Ljavax/crypto/spec/DESedeKeySpec;
    invoke-static { v0 }, Lcom/nd/dianjin/secret/Des3Helper;->a([B)[B
    move-result-object v4
    invoke-direct { v3, v4 }, Ljavax/crypto/spec/DESedeKeySpec;-><init>([B)V
    invoke-virtual { v2, v3 }, Ljavax/crypto/SecretKeyFactory;->generateSecret(Ljava/security/spec/KeySpec;)Ljavax/crypto/SecretKey;
    move-result-object v2
    new-array v3, v6, [B
    invoke-static { v0, v5, v3, v5, v6 }, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
    new-instance v0, Ljavax/crypto/spec/IvParameterSpec;
    invoke-direct { v0, v3 }, Ljavax/crypto/spec/IvParameterSpec;-><init>([B)V
    const/4 v3, 1
    invoke-virtual { v1, v3, v2, v0 }, Ljavax/crypto/Cipher;->init(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
    invoke-virtual { v1, p0 }, Ljavax/crypto/Cipher;->doFinal([B)[B
    move-result-object v0
    return-object v0
.end method

.method private static a([B)[B
    .registers 7
    const/16 v1, 24
    const/4 v2, 0
    array-length v3, p0
    array-length v0, p0
    if-ge v0, v1, :L1
    new-array v0, v1, [B
    rsub-int/lit8 v1, v3, 24
    new-array v4, v1, [B
    move v1, v2
    :L0
    rsub-int/lit8 v5, v3, 24
    if-lt v1, v5, :L2
    invoke-static { p0, v2, v0, v2, v3 }, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
    rsub-int/lit8 v1, v3, 24
    invoke-static { v4, v2, v0, v3, v1 }, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
    move-object p0, v0
    :L1
    return-object p0
    :L2
    aput-byte v2, v4, v1
    add-int/lit8 v1, v1, 1
    goto :L0
.end method

.method public static generateKey(I)V
    .catch Ljava/security/NoSuchAlgorithmException; { :L0 .. :L4 } :L5
    .registers 6
    const-string v0, ""
    sput-object v0, Lcom/nd/dianjin/secret/Des3Helper;->key:Ljava/lang/String;
    :L0
    const-string v0, "DESede"
    invoke-static { v0 }, Ljavax/crypto/KeyGenerator;->getInstance(Ljava/lang/String;)Ljavax/crypto/KeyGenerator;
    move-result-object v0
    invoke-virtual { v0 }, Ljavax/crypto/KeyGenerator;->generateKey()Ljavax/crypto/SecretKey;
    move-result-object v0
    invoke-interface { v0 }, Ljavax/crypto/SecretKey;->getEncoded()[B
    move-result-object v1
    new-instance v2, Ljava/lang/StringBuilder;
    invoke-direct { v2, p0 }, Ljava/lang/StringBuilder;-><init>(I)V
    const/4 v0, 0
    :L1
    div-int/lit8 v3, p0, 2
    if-lt v0, v3, :L3
    invoke-virtual { v2 }, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
    move-result-object v0
    sput-object v0, Lcom/nd/dianjin/secret/Des3Helper;->key:Ljava/lang/String;
    :L2
    return-void
    :L3
    sget-object v3, Lcom/nd/dianjin/secret/Des3Helper;->a:[C
    aget-byte v4, v1, v0
    and-int/lit16 v4, v4, 240
    ushr-int/lit8 v4, v4, 4
    aget-char v3, v3, v4
    invoke-virtual { v2, v3 }, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
    sget-object v3, Lcom/nd/dianjin/secret/Des3Helper;->a:[C
    aget-byte v4, v1, v0
    and-int/lit8 v4, v4, 15
    aget-char v3, v3, v4
    invoke-virtual { v2, v3 }, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
    :L4
    add-int/lit8 v0, v0, 1
    goto :L1
    :L5
    move-exception v0
    const-string v1, "Des3Helper"
    invoke-virtual { v0 }, Ljava/security/NoSuchAlgorithmException;->toString()Ljava/lang/String;
    move-result-object v0
    invoke-static { v1, v0 }, Lcom/nd/dianjin/utility/LogUtil;->e(Ljava/lang/String;Ljava/lang/String;)V
    goto :L2
.end method
